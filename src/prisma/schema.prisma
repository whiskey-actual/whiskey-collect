// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model Device {
  id        Int       @id @default(autoincrement())
  name      String    @unique
  isActive  Boolean?  @default(false)
  firstSeen DateTime?
  lastSeen  DateTime?

  // active directory details
  ad_dn                 String?   @unique
  ad_dnsHostName        String?
  ad_logonCount         Int?     @default(0)
  ad_whenCreated        DateTime?
  ad_whenChanged        DateTime?
  ad_lastLogon          DateTime?
  ad_pwdLastSet         DateTime?
  ad_LastLogonTimestamp DateTime?
  ad_lastSeen           DateTime?

  // azure active directory details
  aad_deviceId                      String?    @unique
  aad_id                            String?
  aad_deviceCategory                String?
  aad_deviceMetadata                String? //always null
  aad_deviceOwnership               String?
  aad_deviceVersion                 String?
  aad_domainName                    String? //always null
  aad_enrollmentProfileType         String? //always null
  aad_enrollmentType                String?
  aad_externalSourceName            String? //always null
  aad_managementType                String?
  aad_manufacturer                  String?
  aad_mDMAppId                      String?
  aad_model                         String?
  aad_profileType                   String?
  aad_sourceType                    String? //always null
  aad_trustType                     String?
  aad_deletedDateTime               DateTime?
  aad_approximateLastSignInDateTime DateTime?
  aad_complianceExpirationDateTime  DateTime?
  aad_createdDateTime               DateTime?
  aad_onPremisesLastSyncDateTime    DateTime?
  aad_registrationDateTime          DateTime?
  aad_onPremisesSyncEnabled         Boolean?  @default(false)
  aad_accountEnabled                Boolean?  @default(false)
  aad_isCompliant                   Boolean?  @default(false)
  aad_isManaged                     Boolean?  @default(false)
  aad_isRooted                      Boolean?  @default(false)

  // azure managed (mdm)
  aadm_id                                        String?    @unique
  aadm_deviceName                                String?
  aadm_userId                                    String?
  aadm_deviceOwnerType                           String?
  aadm_complianceState                           String?
  aadm_jailBroken                                String?
  aadm_managementAgent                           String?
  aadm_easDeviceID                               String?
  aadm_deviceEnrollmentType                      String?
  aadm_activationLockBypassCode                  String?
  aadm_emailAddress                              String?
  aadm_azureADDeviceID                           String?
  aadm_deviceRegistrationState                   String?
  aadm_deviceCategoryDisplayName                 String?
  aadm_exchangeAccessState                       String?
  aadm_exchangeAccessStateReason                 String?
  aadm_remoteAssistanceSessionUrl                String?
  aadm_remoteAssistanceErrorDetails              String?
  aadm_userPrincipalName                         String?
  aadm_model                                     String?
  aadm_manufacturer                              String?
  aadm_imei                                      String?
  aadm_serialNumber                              String?
  aadm_phoneNumber                               String?
  aadm_androidSecurityPatchLevel                 String?
  aadm_userDisplayName                           String?
  aadm_configurationManagerClientEnabledFeatures String?
  aadm_wifiMACAddress                            String?
  aadm_deviceHealthAttestationState              String?
  aadm_subscriberCarrier                         String?
  aadm_meid                                      String?
  aadm_partnerReportedThreatState                String?
  aadm_requireUserEnrollmentApproval             String?
  aadm_iccId                                     String?
  aadm_udId                                      String?
  aadm_notes                                     String?
  aadm_ethernetMacAddress                        String?
  aadm_totalStorageSpaceInBytes                  BigInt?
  aadm_freeStorageSpaceInBytes                   BigInt?
  aadm_physicalMemoryInBytes                     BigInt?
  aadm_enrolledDateTime                          DateTime?
  aadm_lastSyncDateTime                          DateTime?
  aadm_easActivationDateTime                     DateTime?
  aadm_exchangeLastSuccessfulSyncDateTime        DateTime?
  aadm_complianceGracePeriodExpirationDateTime   DateTime?
  aadm_managementCertificateExpirationDateTime   DateTime?
  aadm_isEASActivated                            Boolean?  @default(false)
  aadm_isAzureADRegistered                       Boolean?  @default(false)
  aadm_isSupervised                              Boolean?  @default(false)
  aadm_isEncrypted                               Boolean?  @default(false)

  // connectwise details
  cw_id                      String?
  cw_deviceType              String?
  cw_location                String?
  cw_client                  String?
  cw_domainName              String?
  cw_agentVersion            String?
  cw_comment                 String?
  cw_ipAddress               String?
  cw_macAddress              String?
  cw_lastUserName            String?
  cw_status                  String?
  cw_serialNumber            String?
  cw_manufacturer            String?
  cw_model                   String?
  cw_description             String?
  cw_totalMemory             BigInt?
  cw_freeMemory              BigInt?
  cw_firstSeen               DateTime?
  cw_lastObserved            DateTime?
  cw_windowsUpdateDate       DateTime?
  cw_antivirusDefinitionDate DateTime?
  cw_assetDate               DateTime?

  // crowdstrike details
  cs_deviceId                 String?
  cs_cid                      String?
  cs_agentVersion             String?
  cs_biosManufacturer         String?
  cs_biosVersion              String?
  cs_externalIP               String?
  cs_macAddress               String?
  cs_localIP                  String?
  cs_machineDomain            String?
  cs_majorVersion             String?
  cs_minorVersion             String?
  cs_osVersion                String?
  cs_osBuild                  String?
  cs_platformName             String?
  cs_reducedFunctionalityMode String?
  cs_productTypeDesc          String?
  cs_provisionStatus          String?
  cs_serialNumber             String?
  cs_servicePackMajor         String?
  cs_servicePackMinor         String?
  cs_status                   String?
  cs_systemManufacturer       String?
  cs_systemProductName        String?
  cs_kernelVersion            String?
  cs_firstSeenDateTime        DateTime?
  cs_lastSeenDateTime         DateTime?
  cs_modifiedDateTime         DateTime?

  operatingSystem   OperatingSystem? @relation(fields: operatingSystemId, references: [id])
  operatingSystemId Int?
}

model OperatingSystem {
  id          Int      @id @default(autoincrement())
  description String
  version     String?
  variant     String?
  Device      Device[]
}
